<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contacto | HuertoHogar</title>

  <!-- Bootstrap 5.3.8 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <!-- Estilos propios -->
  <link rel="stylesheet" href="../css/styles.css" />
</head>
<body class="bg-light">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold text-success" href="../index.html">ðŸ¥‘ HuertoHogar</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav"
        aria-controls="nav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>

      <div class="collapse navbar-collapse" id="nav">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="../index.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="productos.html">Productos</a></li>
          <li class="nav-item"><a class="nav-link" href="nosotros.html">Nosotros</a></li>
          <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
          <li class="nav-item"><a class="nav-link active" aria-current="page" href="contacto.html">Contacto</a></li>
          <li class="nav-item"><a class="nav-link" href="login.html">Iniciar sesiÃ³n</a></li>
          <li class="nav-item"><a class="btn btn-outline-success ms-2" href="carrito.html">ðŸ›’ Carrito</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="bg-white border-bottom">
    <div class="container py-4">
      <h1 class="h3 text-success fw-bold mb-0">ContÃ¡ctanos</h1>
      <p class="text-muted mb-0">EscrÃ­benos tus dudas o comentarios. Responderemos a la brevedad.</p>
    </div>
  </header>

  <main class="container my-4" style="max-width: 760px;">
    <form id="form-contacto" novalidate class="needs-validation card shadow-sm">
      <div class="card-body p-4">

        <div class="mb-3">
          <label for="nombre" class="form-label">Nombre <span class="text-danger">*</span></label>
          <input id="nombre" name="nombre" type="text" class="form-control" required maxlength="100" />
          <div class="invalid-feedback">Ingresa tu nombre (mÃ¡x. 100 caracteres).</div>
        </div>

        <div class="mb-3">
          <label for="correo" class="form-label">Correo electrÃ³nico</label>
          <input id="correo" name="correo" type="email" class="form-control" maxlength="100" placeholder="usuario@duoc.cl" />
          <div class="form-text">Dominios permitidos: @duoc.cl, @profesor.duoc.cl, @gmail.com</div>
          <div class="invalid-feedback" id="err-correo">Ingresa un correo permitido.</div>
        </div>

        <div class="mb-3">
          <label for="comentario" class="form-label">Comentario <span class="text-danger">*</span></label>
          <textarea id="comentario" name="comentario" class="form-control" rows="6" required maxlength="500" placeholder="CuÃ©ntanos en quÃ© te ayudamosâ€¦"></textarea>
          <div class="d-flex justify-content-between">
            <div class="invalid-feedback">Este campo es obligatorio (mÃ¡x. 500 caracteres).</div>
            <small id="contador" class="text-muted">0 / 500</small>
          </div>
        </div>

        <div class="d-flex gap-2">
          <button class="btn btn-success" type="submit">Enviar</button>
          <button class="btn btn-outline-secondary" type="reset">Limpiar</button>
        </div>
      </div>
    </form>

    <!-- Mensaje de Ã©xito simulado -->
    <div id="ok" class="alert alert-success mt-4 d-none" role="alert">
      âœ… Mensaje enviado (simulado para la evaluaciÃ³n). Â¡Gracias por escribirnos!
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-white border-top py-4 mt-5">
    <div class="container d-flex justify-content-between flex-wrap">
      <small>Â© <span id="year"></span> HuertoHogar.</small>
      <div>
        <a href="#" class="text-muted me-3">Privacidad</a>
        <a href="#" class="text-muted me-3">TÃ©rminos</a>
        <a href="#" class="text-muted">Accesibilidad</a>
      </div>
    </div>
  </footer>

  <!-- JS compartido -->
  <script src="../js/main.js"></script>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

  <!-- ValidaciÃ³n especÃ­fica de la vista -->
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // Validador de dominios permitidos (si el usuario ingresa correo)
    function correoPermitido(v) {
      if (!v) return true; // el correo es opcional en contacto
      v = v.toLowerCase();
      return v.endsWith('@duoc.cl') || v.endsWith('@profesor.duoc.cl') || v.endsWith('@gmail.com');
    }

    // Contador de caracteres del comentario
    const comentario = document.getElementById('comentario');
    const contador = document.getElementById('contador');
    comentario.addEventListener('input', () => {
      const len = (comentario.value || '').length;
      contador.textContent = `${len} / 500`;
    });

    const form = document.getElementById('form-contacto');
    form.addEventListener('submit', (e) => {
      let ok = true;

      // validaciÃ³n nativa
      if (!form.checkValidity()) ok = false;

      // correo con dominios permitidos si fue ingresado
      const correo = document.getElementById('correo');
      if (!correoPermitido(correo.value)) {
        ok = false;
        correo.classList.add('is-invalid');
        document.getElementById('err-correo').textContent = 'El correo debe pertenecer a @duoc.cl, @profesor.duoc.cl o @gmail.com';
      } else {
        correo.classList.remove('is-invalid');
      }

      // comentario requerido y <= 500
      const com = document.getElementById('comentario');
      if ((com.value || '').trim().length === 0 || (com.value || '').length > 500) {
        ok = false;
        com.classList.add('is-invalid');
      } else {
        com.classList.remove('is-invalid');
      }

      if (!ok) {
        e.preventDefault();
        e.stopPropagation();
      } else {
        e.preventDefault(); // simulaciÃ³n para la evaluaciÃ³n
        form.reset();
        contador.textContent = '0 / 500';
        document.getElementById('ok').classList.remove('d-none');
        toast('Mensaje enviado (simulaciÃ³n)', 'success');
      }
      form.classList.add('was-validated');
    });

    // Reset: limpiar estados visuales
    form.addEventListener('reset', () => {
      form.classList.remove('was-validated');
      document.getElementById('ok').classList.add('d-none');
      document.getElementById('correo').classList.remove('is-invalid');
      document.getElementById('comentario').classList.remove('is-invalid');
      contador.textContent = '0 / 500';
    });
  </script>
</body>
</html>
