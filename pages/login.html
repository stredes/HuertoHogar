<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Iniciar sesi√≥n | HuertoHogar</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link rel="stylesheet" href="../css/styles.css" />
</head>
<body class="bg-light d-flex align-items-center" style="min-height:100vh;">

  <main class="container" style="max-width:520px;">
    <div class="card shadow-sm">
      <div class="card-body p-4">
        <div class="text-center mb-3">
          <a class="text-decoration-none fw-bold text-success" href="../index.html">ü•ë HuertoHogar</a>
        </div>
        <h1 class="h4 text-success fw-bold mb-3 text-center">Iniciar sesi√≥n</h1>

        <form id="form-login" novalidate class="needs-validation">
          <div class="mb-3">
            <label for="correo" class="form-label">Correo <span class="text-danger">*</span></label>
            <input id="correo" type="email" class="form-control" required maxlength="100" placeholder="usuario@duoc.cl" />
            <div class="form-text">Dominios permitidos: @duoc.cl, @profesor.duoc.cl, @gmail.com</div>
            <div class="invalid-feedback" id="err-correo">Ingresa un correo permitido.</div>
          </div>

          <div class="mb-3">
            <label for="pass" class="form-label">Contrase√±a <span class="text-danger">*</span></label>
            <input id="pass" type="password" class="form-control" required minlength="4" maxlength="10" />
            <div class="invalid-feedback">La contrase√±a debe tener entre 4 y 10 caracteres.</div>
          </div>

          <div class="d-grid gap-2">
            <button class="btn btn-success" type="submit">Entrar</button>
            <a class="btn btn-outline-success" href="registro.html">Crear cuenta</a>
          </div>
        </form>

        <!-- Mensaje de demo -->
        <div id="ok" class="alert alert-success mt-3 d-none" role="alert">
          ‚úÖ Inicio de sesi√≥n simulado (solo evaluaci√≥n). Redirigiendo a <a href="productos.html" class="alert-link">Productos</a>‚Ä¶
        </div>
      </div>
    </div>
  </main>

  <script src="../js/main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

  <script>
    // Validaci√≥n de dominios permitidos
    function correoPermitido(v) {
      if (!v) return false;
      v = v.toLowerCase();
      return v.endsWith('@duoc.cl') || v.endsWith('@profesor.duoc.cl') || v.endsWith('@gmail.com');
    }

    const form = document.getElementById('form-login');
    form.addEventListener('submit', (e) => {
      let ok = true;

      if (!form.checkValidity()) ok = false;

      const correo = document.getElementById('correo');
      if (!correoPermitido(correo.value)) {
        ok = false;
        correo.classList.add('is-invalid');
        document.getElementById('err-correo').textContent = 'El correo debe pertenecer a @duoc.cl, @profesor.duoc.cl o @gmail.com';
      } else {
        correo.classList.remove('is-invalid');
      }

      const pass = document.getElementById('pass');
      if ((pass.value || '').length < 4 || (pass.value || '').length > 10) {
        ok = false;
      }

      if (!ok) {
        e.preventDefault();
        e.stopPropagation();
      } else {
        e.preventDefault(); // simulaci√≥n
        document.getElementById('ok').classList.remove('d-none');
        // redirecci√≥n simulada
        setTimeout(()=> location.href = 'productos.html', 950);
      }
      form.classList.add('was-validated');
    });
  </script>
</body>
</html>
