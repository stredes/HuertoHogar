<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Art√≠culo | HuertoHogar</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link rel="stylesheet" href="../css/styles.css" />
</head>
<body class="bg-light">

  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold text-success" href="../index.html">ü•ë HuertoHogar</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="nav" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="../index.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="blog.html">Blog</a></li>
          <li class="nav-item"><a class="nav-link" href="productos.html">Productos</a></li>
          <li class="nav-item"><a class="btn btn-outline-success ms-2" href="carrito.html">üõí Carrito</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <header class="bg-white border-bottom">
    <div class="container py-3">
      <a href="javascript:history.back()" class="text-decoration-none">&larr; Volver</a>
    </div>
  </header>

  <main class="container my-4" id="contenido">
    <!-- Se rellena por JS -->
  </main>

  <section class="container my-5" id="relacionados"></section>

  <footer class="bg-white border-top py-4 mt-5">
    <div class="container d-flex justify-content-between flex-wrap">
      <small>¬© <span id="year"></span> HuertoHogar.</small>
      <div>
        <a href="#" class="text-muted me-3">Privacidad</a>
        <a href="#" class="text-muted me-3">T√©rminos</a>
        <a href="#" class="text-muted">Accesibilidad</a>
      </div>
    </div>
  </footer>

  <script src="../js/main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
          crossorigin="anonymous"></script>

  <script>
    // Mismo set que en blog.html (podr√≠as extraer a un archivo si prefieres)
    const POSTS = [
      {
        slug: "recetas-de-temporada-con-espinacas",
        titulo: "Recetas de temporada con espinacas",
        categoria: "Recetas",
        fecha: "2025-08-28",
        img: "https://images.unsplash.com/photo-1547056961-3a1e3a6ffbaf?q=80&w=1200",
        contenido: `
          <p>Las <strong>espinacas frescas</strong> son vers√°tiles y ricas en hierro y vitaminas.
          Aqu√≠ van tres ideas r√°pidas:</p>
          <ol>
            <li><em>Salteado</em> con ajo y aceite de oliva.</li>
            <li><em>Tortilla</em> con huevos de campo y queso rallado.</li>
            <li><em>Smoothie verde</em> con pl√°tano y miel org√°nica.</li>
          </ol>
          <p>Compra espinacas en <a href="productos.html">nuestro cat√°logo</a> y pru√©balas hoy mismo.</p>
        `
      },
      {
        slug: "como-conservar-frutas-por-mas-tiempo",
        titulo: "C√≥mo conservar frutas por m√°s tiempo",
        categoria: "Consejos",
        fecha: "2025-08-20",
        img: "https://images.unsplash.com/photo-1570913149827-d2ac84ab3f9a?q=80&w=1200",
        contenido: `
          <p>Para extender la vida √∫til de tus frutas:</p>
          <ul>
            <li>Gu√°rdalas en un lugar <strong>ventilado</strong> y seco.</li>
            <li>Separa las maduras de las verdes para evitar <em>etileno</em> excesivo.</li>
            <li>No laves hasta justo antes de consumir.</li>
          </ul>
          <p>Revisa nuestras <a href="productos.html">frutas frescas</a> seleccionadas.</p>
        `
      },
      {
        slug: "alianzas-con-agricultores-locales",
        titulo: "Alianzas con agricultores locales",
        categoria: "Noticias",
        fecha: "2025-08-10",
        img: "https://images.unsplash.com/photo-1506806732259-39c2d0268443?q=80&w=1200",
        contenido: `
          <p>Seguimos sumando productores locales para asegurar <strong>frescura</strong> y
          <strong>trazabilidad</strong> en todo Chile. Estas alianzas fortalecen la econom√≠a regional.</p>
        `
      }
    ];

    function getParam(name){
      const url = new URL(location.href);
      return url.searchParams.get(name);
    }

    function renderDetalle(){
      const slug = getParam('slug');
      const cont = document.getElementById('contenido');

      const post = POSTS.find(p => p.slug === slug);
      if (!post){
        cont.innerHTML = `<div class="alert alert-warning">No se encontr√≥ el art√≠culo.</div>`;
        return;
      }

      cont.innerHTML = `
        <article class="card shadow-sm">
          <img src="${post.img}" class="card-img-top" alt="${post.titulo}">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span class="badge bg-secondary">${post.categoria}</span>
              <small class="text-muted">${new Date(post.fecha).toLocaleDateString('es-CL')}</small>
            </div>
            <h1 class="h3 text-success fw-bold">${post.titulo}</h1>
            <div class="mt-3 post-body">${post.contenido}</div>

            <hr class="my-4" />
            <div class="d-flex gap-2">
              <a href="blog.html" class="btn btn-outline-success">‚Üê Volver al blog</a>
              <a href="productos.html" class="btn btn-success">Ver productos</a>
            </div>
          </div>
        </article>
      `;

      renderRelacionados(post);
    }

    function renderRelacionados(post){
      const otros = POSTS.filter(p => p.categoria === post.categoria && p.slug !== post.slug).slice(0,3);
      const sec = document.getElementById('relacionados');
      if (otros.length === 0){
        sec.innerHTML = "";
        return;
      }

      let html = `
        <h2 class="h5 text-success fw-bold mb-3">Art√≠culos relacionados</h2>
        <div class="row g-4">
      `;
      for (const p of otros){
        html += `
          <div class="col-12 col-md-6 col-xl-4">
            <article class="card h-100 shadow-sm">
              <img src="${p.img}" class="card-img-top" alt="${p.titulo}">
              <div class="card-body d-flex flex-column">
                <div class="d-flex justify-content-between align-items-center mb-2">
                  <span class="badge bg-secondary">${p.categoria}</span>
                  <small class="text-muted">${new Date(p.fecha).toLocaleDateString('es-CL')}</small>
                </div>
                <h3 class="h6">${p.titulo}</h3>
                <a class="btn btn-outline-success mt-auto" href="blog_detalle.html?slug=${encodeURIComponent(p.slug)}">Leer m√°s</a>
              </div>
            </article>
          </div>
        `;
      }
      html += `</div>`;
      sec.innerHTML = html;
    }

    document.getElementById('year').textContent = new Date().getFullYear();
    document.addEventListener('DOMContentLoaded', () => {
      renderDetalle();
      updateCartBadge();
    });
  </script>
</body>
</html>
